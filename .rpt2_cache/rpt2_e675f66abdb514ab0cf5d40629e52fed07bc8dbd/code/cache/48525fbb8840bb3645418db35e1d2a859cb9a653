{"map":"{\"version\":3,\"file\":\"webvitals.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/core/webvitals.ts\"],\"names\":[],\"mappings\":\"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\"}","code":"import { onCLS, onFID, onLCP } from 'web-vitals';\nimport { createApiReporter, getDeviceInfo } from 'web-vitals-reporter';\n//前置知识：\n// LCP (Largest Contentful Paint)：网页加载速度指标。这个指标实际上是记录页面首屏可见区域中最大元素的呈现时间。\n// FID (First Input Delay)：网页可交互指标。其含义就是从用户首次和 Web 应用互动到浏览器实际开始处理事件或者处理脚本，响应用户互动的这段时间。\n// CLS (Cumulative Layout Shift)：网页视觉稳定性指标。这个指标更多的是判断用户的视觉上的体验，也就是在浏览器可视区内现有元素发生位置的改变，触发布局偏移，是否影响用户的使用体验。\n// FCP (First Contentful Pain)：首次内容绘制。这个指标记录的是页面渲染出来的第一个非空白元素的渲染时间。\n// INP (Interaction to Next Paint)：互动响应速度。用来监听用户交互互动到页面响应的延迟时间。如果用户在一个页面内的多次互动，那么 INP 会记录多个指标数据，并以最长延迟时间的那一次互动作为最终值。\n// TTI (Time to Interactive)：可交互时间。衡量从网页开始加载到其主要子资源加载完成的时间。从定义上看，这个时间比 FCP 更靠前。（实验性指标）\n// TBT (Total Blocking Time)：总阻塞时间。这是一个衡量页面从首次内容绘制（First Contentful Paint, FCP）到交互就绪（Time to Interactive, TTI）这段时间内，所有长任务导致的主线程阻塞总时间的指标。长任务是指执行时间超过 50 毫秒的任务。\n// TTFB (Time to First Byte)：首字节时间。从发起请求到浏览器接收到第一个字节的时间间隔。反映了服务器响应的速度，以及网络传输的效率。\nvar SCORE_RANGE_LCP = [2500, 4500];\nvar SCORE_RANGE_FID = [100, 300];\nvar SCORE_RANGE_CLS = [0.1, 0.25];\nvar SCORE_RANGE_FCP = [1.8, 3];\nvar SCORE_RANGE_INP = [200, 500];\nvar SCORE_RANGE_TTFB = [800, 1800];\nvar score = function (value, range) {\n    return value < range[0] ? 'good' : value < range[1] ? 'needs improvement' : 'poor';\n};\nexport function generateUniqueId() {\n    return \"v1-\".concat(Date.now(), \"-\").concat(Math.floor(Math.random() * (9e12 - 1)) + 1e12);\n}\nfunction round(val, precision) {\n    if (precision === void 0) { precision = 0; }\n    // @ts-ignore\n    return +(Math.round(\"\".concat(val, \"e+\").concat(precision)) + \"e-\".concat(precision));\n}\nexport function mapMetric(metric) {\n    var _a;\n    var isWebVital = ['FCP', 'TTFB', 'LCP', 'CLS', 'FID'].indexOf(metric.name) !== -1;\n    return _a = {},\n        _a[metric.name] = isWebVital ? round(metric.value, metric.name === 'CLS' ? 4 : 0) : metric.value,\n        _a[\"\".concat(metric.name, \"Rating\")] = metric.rating,\n        _a;\n}\n;\nvar sendToAnalytics = createApiReporter('/analytics', {\n    initial: getDeviceInfo(),\n    beforeSend: function (result) {\n        console.log('beforeSend');\n        var LCP = result.LCP, FID = result.FID, CLS = result.CLS;\n        console.info('web-vitals: ', result);\n        if (!LCP || !FID || !CLS)\n            return; // Core Web Vitals are not supported\n        // return extra attributes to merge into the final result\n        return {\n            LCPScore: score(LCP, SCORE_RANGE_LCP),\n            // FIDScore: FID < 100 ? 'good' : FID < 300 ? 'needs improvement' : 'poor',\n            FIDScore: score(FID, SCORE_RANGE_FID),\n            // CLSScore: CLS < 0.1 ? 'good' : CLS < 0.25 ? 'needs improvement' : 'poor'\n            CLSScore: score(CLS, SCORE_RANGE_CLS),\n        };\n    },\n});\nexport var onVitals = function (saveMetric) {\n    console.log('---------------------webvitals setup---------------------');\n    onLCP(saveMetric);\n    onFID(saveMetric);\n    onCLS(saveMetric);\n    // onTTFB(saveMetric)\n    // onINP(saveMetric)\n    // onFCP(saveMetric)\n};\nexport default {};\n//# sourceMappingURL=webvitals.js.map","dts":{"name":"D:/PersonalProject/fontend-trace-geekbang-course/trace-sdk/dist/types/core/webvitals.d.ts","writeByteOrderMark":false,"text":"export declare function generateUniqueId(): string;\nexport declare function mapMetric(metric: any): {\n    [x: string]: any;\n    [x: number]: any;\n};\nexport declare const onVitals: (saveMetric: any) => void;\ndeclare const _default: {};\nexport default _default;\n"}}
